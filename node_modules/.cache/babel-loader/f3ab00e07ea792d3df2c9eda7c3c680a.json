{"remainingRequest":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\src\\views\\users\\center\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\src\\views\\users\\center\\index.vue","mtime":1630326254245},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _validate = require(\"@/utils/validate\");\n\nvar _login = require(\"@/api/login\");\n\nvar _usercenter = require(\"@/api/users/usercenter\");\n\nvar _auth = require(\"@/utils/auth\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  name: 'center',\n  data: function data() {\n    // 自定义验证\n    var validPhone = function validPhone(rule, value, callback) {\n      if (!value) {\n        callback(new Error('请输入电话号码'));\n      } else if (!(0, _validate.isvalidPhone)(value)) {\n        callback(new Error('请输入正确的11位手机号码'));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      // 查询参数\n      queryParams: {\n        queryText: undefined,\n        pageIndex: 1,\n        pageSize: 10,\n        orderby: 'userID',\n        sort: 'descending'\n      },\n      // 标签页\n      activeName: 'user',\n      // 上传链接\n      avatarUploadUrl: process.env.VUE_APP_BASE_API + '/userCenter/AvatarUpload',\n      headers: {\n        SYSTOKEN: (0, _auth.getToken)()\n      },\n      // 加载中\n      loading: false,\n      // 图片路径\n      imageUrl: '',\n      // 用户信息列表\n      userForm: {},\n      // 密码列表\n      passwordForm: {},\n      // 校验规则\n      rules: {\n        nickName: [{\n          required: true,\n          message: '请输入用户昵称',\n          trigger: 'blur'\n        }, {\n          min: 2,\n          max: 20,\n          message: '长度在 2 到 20 个字符',\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: true,\n          trigger: 'blur',\n          validator: validPhone\n        }]\n      },\n      // 重置密码表单校验\n      passwordRules: {\n        currentPassword: [{\n          required: true,\n          message: '原密码不能为空',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          message: '用户密码长度至少6位',\n          trigger: 'blur'\n        }],\n        confirmPassword: [{\n          required: true,\n          message: '用户密码不能为空',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          message: '用户密码长度至少6位',\n          trigger: 'blur'\n        }],\n        newPassword: [{\n          required: true,\n          message: '确认密码不能为空',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          message: '用户密码长度至少6位',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.getUserInfo();\n  },\n  methods: {\n    // 获取用户信息\n    getUserInfo: function getUserInfo() {\n      var _this = this;\n\n      (0, _login.getUserInfo)().then(function (response) {\n        _this.userForm = response.data;\n      });\n    },\n    // 点击确定按钮\n    handleSubmit: function handleSubmit() {\n      var _this2 = this;\n\n      this.$refs['form'].validate(function (valid) {\n        if (valid) {\n          (0, _usercenter.updateUser)(_this2.userForm).then(function (response) {\n            _this2.loading = true;\n\n            if (response.statusCode === 200) {\n              _this2.$message({\n                message: '修改成功',\n                type: 'success'\n              });\n\n              _this2.getUserInfo();\n            }\n\n            _this2.loading = false;\n          });\n        }\n      });\n    },\n    // 修改密码提交\n    submitPasswordForm: function submitPasswordForm() {\n      var _this3 = this;\n\n      this.$refs['passwordForm'].validate(function (valid) {\n        if (valid) {\n          if (_this3.passwordForm.newPassword !== _this3.passwordForm.confirmPassword) {\n            _this3.$message.error('两次密码输入不一致');\n\n            return;\n          }\n\n          (0, _usercenter.updatePassword)({\n            currentPassword: _this3.passwordForm.currentPassword,\n            confirmPassword: _this3.passwordForm.confirmPassword\n          }).then(function (response) {\n            if (response.statusCode === 200) {\n              _this3.$message({\n                message: '密码重置成功',\n                type: 'success'\n              });\n            }\n          });\n        }\n      });\n    },\n    // 图片上传成功\n    handleAvatarSuccess: function handleAvatarSuccess(response, file) {\n      if (response.statusCode === 200) {\n        this.getUserInfo();\n        this.$message({\n          message: '图片上传成功',\n          type: 'success'\n        });\n      }\n    }\n  }\n};\nexports.default = _default;",null]}