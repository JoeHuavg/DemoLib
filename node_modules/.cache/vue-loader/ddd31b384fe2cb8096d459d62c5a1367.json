{"remainingRequest":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\src\\views\\users\\roleusers\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\src\\views\\users\\roleusers\\index.vue","mtime":1630326254249},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Amazarashi\\Documents\\P_Project\\Clothes\\后台\\Design\\Meiam.System\\Meiam.System.Web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { getRoles } from '@/api/users/roles'\r\nimport {\r\n  getRoleUsers,\r\n  createRoleUsers,\r\n  deleteRoleUsers,\r\n  getExcludeUsers\r\n} from '@/api/users/roleusers'\r\nexport default {\r\n  name: 'roleusers',\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loadingRole: false,\r\n      loadingUser: false,\r\n      loadingRoleUser: false,\r\n      // 表格高度\r\n      tableHeight: window.innerHeight,\r\n      // 角色列表\r\n      dataRoleTable: [],\r\n      // 已添加用户列表\r\n      dataRoleUserTable: [],\r\n      // 未添加用户列表\r\n      dataUserTable: [],\r\n      // 勾选添加用户列表\r\n      addSelections: [],\r\n      // 勾选删除用户列表\r\n      delSelections: [],\r\n      // 过滤查询\r\n      search: '',\r\n      // 角色id\r\n      roleId: '',\r\n      // 是否显示弹出层\r\n      open: false\r\n    }\r\n  },\r\n  created() {\r\n    // 获取角色列表\r\n    this.loadingRole = true\r\n    getRoles().then(response => {\r\n      this.dataRoleTable = response.data\r\n      this.handleRoleTableSelection(this.dataRoleTable[0])\r\n      this.$refs.roleTable.setCurrentRow(this.dataRoleTable[0])\r\n      this.loadingRole = false\r\n    })\r\n  },\r\n  methods: {\r\n    // 获取角色用户\r\n    getRoleUser() {\r\n      this.loadingRoleUser = true\r\n      getRoleUsers(this.roleId).then(response => {\r\n        this.dataRoleUserTable = response.data\r\n        this.loadingRoleUser = false\r\n      })\r\n    },\r\n    // 删除角色用户\r\n    handleDelete() {\r\n      this.delSelections = []\r\n      this.$refs.roleUserTable.selection.forEach(element => {\r\n        this.delSelections.push(element.userID)\r\n      })\r\n      if (this.delSelections.length === 0) {\r\n        return\r\n      }\r\n      this.$confirm(\r\n        '是否确认删除选中的 ' + this.delSelections.length + ' 条数据?',\r\n        '警告',\r\n        {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }\r\n      )\r\n        .then(() => {\r\n          deleteRoleUsers({\r\n            roleId: this.roleId,\r\n            userIds: this.delSelections\r\n          }).then(response => {\r\n            if (response.statusCode === 200) {\r\n              this.$message({\r\n                message: '成功删除' + response.data + '条数据',\r\n                type: 'success'\r\n              })\r\n              this.getRoleUser()\r\n            }\r\n          })\r\n        })\r\n        .catch(() => {})\r\n    },\r\n    // 选中角色\r\n    handleRoleTableSelection(row) {\r\n      this.roleId = row.id\r\n      this.getRoleUser()\r\n    },\r\n    // 获取未添加角色列表\r\n    handleGetUserTable() {\r\n      this.open = true\r\n      this.loadingUser = true\r\n      getExcludeUsers(this.roleId).then(response => {\r\n        this.dataUserTable = response.data\r\n        this.loadingUser = false\r\n      })\r\n    },\r\n    // 新增用户角色\r\n    handleSubmit() {\r\n      this.addSelections = []\r\n      this.$refs.userTable.selection.forEach(element => {\r\n        this.addSelections.push(element.userID)\r\n      })\r\n      createRoleUsers({\r\n        roleId: this.roleId,\r\n        userIds: this.addSelections\r\n      }).then(response => {\r\n        if (response.statusCode === 200) {\r\n          this.$message({\r\n            message: '成功添加' + response.data + '条数据',\r\n            type: 'success'\r\n          })\r\n          this.getRoleUser()\r\n          this.open = false\r\n        }\r\n      })\r\n    },\r\n    cancel() {\r\n      this.open = false\r\n    }\r\n  }\r\n}\r\n",null]}